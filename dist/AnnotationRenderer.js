!function(global){const Pax={};function file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cnote$2ejs(t,e,s,n,i,a){Object.defineProperty(e,"__esModule",{value:!0}),function(){"use strict";Object.defineProperties(e,{default:{get:()=>i,enumerable:!0},NoteAnnotation:{get:()=>t,enumerable:!0},getFinalAnnotationColor:{get:()=>n,enumerable:!0},decimalToHex:{get:()=>s,enumerable:!0}});class t{static get defaultAppearanceAttributes(){return{bgColor:16777215,bgOpacity:.8,fgColor:0,textSize:3.15}}constructor(t){if(!t)throw new Error("Annotation data must be provided");this.data=t,this.element=document.createElement("div"),this.element.classList.add("__cxt-ar-annotation__"),this.closeElement=this.setupCloseElement(),this.element.append(this.closeElement),this.data.text&&(this.textElement=document.createElement("span"),this.textElement.textContent=this.data.text,this.element.append(this.textElement)),this.setupAppearance(),"speech"!==this.data.style&&"title"!==this.data.style&&this.setupHoverAppearance(),this.element.setAttribute("data-ar-type",this.data.type),this.element.setAttribute("data-ar-style",this.data.style),this.element.setAttribute("hidden",""),this.textScaling=100,this.paddingMultiplier=1,this.closeButtonScaling=.0423,this.closeButtonOffset=-1.8}setupCloseElement(){const t=this.createCloseElement();return t.addEventListener("click",t=>{this.element.setAttribute("hidden",""),this.element.setAttribute("data-ar-closed","")}),t}setupAppearance(){let t=this.constructor.defaultAppearanceAttributes;isNaN(this.data.textSize)||(t.textSize=this.data.textSize),isNaN(this.data.fgColor)||(t.fgColor=this.data.fgColor),isNaN(this.data.bgColor)||(t.bgColor=this.data.bgColor),isNaN(this.data.bgOpacity)||(t.bgOpacity=this.data.bgOpacity),this.data.bgColor=t.bgColor,this.data.bgOpacity=t.bgOpacity,this.data.fgColor=t.fgColor,this.data.textSize=t.textSize,this.element.style.color="#"+s(t.fgColor)}setupHoverAppearance(){const{bgOpacity:t,bgColor:e}=this.data,s=n(t,e);this.element.style.backgroundColor=s,this.element.addEventListener("mouseenter",()=>{this.element.style.backgroundColor=n(t,e,!0),this.closeElement.style.display="block"}),this.element.addEventListener("mouseleave",()=>{this.element.style.backgroundColor=n(t,e,!1),this.closeElement.style.display="none"}),"url"===this.data.actionType&&(this.element.style.cursor="pointer")}createCloseElement(t=10){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("viewBox","0 0 100 100"),e.classList.add("__cxt-ar-annotation-close__");const s=document.createElementNS(e.namespaceURI,"path");s.setAttribute("d","M25 25 L 75 75 M 75 25 L 25 75"),s.setAttribute("stroke","#bbb"),s.setAttribute("stroke-width",t),s.setAttribute("x",5),s.setAttribute("y",5);const n=document.createElementNS(e.namespaceURI,"circle");return n.setAttribute("cx",50),n.setAttribute("cy",50),n.setAttribute("r",50),e.append(n,s),e}show(){this.element.removeAttribute("hidden")}hide(){this.element.setAttribute("hidden","")}updateTextSize(t){if(this.data.textSize){const e=this.data.textSize/this.textScaling*t;this.fontSize=`${e}px`}}updateCloseSize(t){const e=t*this.closeButtonScaling;this.closeElement.style.width=e+"px",this.closeElement.style.height=e+"px",this.closeElement.style.right=e/this.closeButtonOffset+"px",this.closeElement.style.top=e/this.closeButtonOffset+"px",this.closeButtonSize=e}setDimensions(t,e,s,n){this.left=t,this.top=e,this.width=s,this.height=n}setPadding(t,e){t=t*this.paddingMultiplier+"px",e=e*this.paddingMultiplier+"px",this.element.style.padding=`${e} ${t} ${e} ${t}`}get closed(){return this.element.hasAttribute("data-ar-closed")}get hidden(){return this.element.hasAttribute("hidden")}get type(){return this.data.type}get style(){return this.data.style}set left(t){this.element.style.left=t}set top(t){this.element.style.top=t}set width(t){this.element.style.width=t}set height(t){this.element.style.height=t}set fontSize(t){this.element.style.fontSize=t}}function s(t){let e=t.toString(16);return e="000000".substr(0,6-e.length)+e}function n(t,e,n=!1,i=230){if(!isNaN(t)&&!isNaN(e)){const a=n?i.toString(16):Math.floor(255*t).toString(16);return`#${s(e)}${a}`}return"#FFFFFFFF"}const i=t}()}function file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cspeech$2ejs(module,exports,require,__filename,__dirname,__import_meta){with(Object.defineProperty(exports,"__esModule",{value:!0}),function(){const t=require._esModule("./note.js");return Object.freeze(Object.create(null,{[Symbol.toStringTag]:{value:"ModuleImports"},NoteAnnotation:{get:()=>t.NoteAnnotation,enumerable:!0},getFinalAnnotationColor:{get:()=>t.getFinalAnnotationColor,enumerable:!0}}))}())!function(){"use strict";Object.defineProperties(exports,{default:{get:()=>t,enumerable:!0}});const t=class extends NoteAnnotation{static get horizontalBaseStartMultiplier(){return.17379070765180116}static get horizontalBaseEndMultiplier(){return.14896346370154384}static get verticalBaseStartMultiplier(){return.12}static get verticalBaseEndMultiplier(){return.3}constructor(t){super(t),this.createSpeechBubble(),this.setupHoverAppearance(),this.textX=0,this.textY=0,this.textWidth=0,this.textHeight=0,this.baseStartX=0,this.baseStartY=0,this.baseEndX=0,this.baseEndY=0,this.pointX=0,this.pointY=0,this.directionPadding=20,this.paddingMultiplier=2}getPointDirection(t,e,s,n,i,a,o=20){return i>t+s-s/2&&a>e+n?"br":i<t+s-s/2&&a>e+n?"bl":i>t+s-s/2&&a<e-o?"tr":i<t+s-s/2&&a<e?"tl":i>t+s&&a>e-o&&a<e+n-o?"r":i<t&&a>e&&a<e+n?"l":void 0}createSpeechBubble(t="white"){this.speechSvg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.speechSvg.classList.add("__cxt-ar-annotation-speech-bubble__"),this.speechSvg.style.position="absolute",this.speechSvg.setAttribute("width","100%"),this.speechSvg.setAttribute("height","100%"),this.speechSvg.style.left="0",this.speechSvg.style.left="0",this.speechSvg.style.display="block",this.speechSvg.style.overflow="visible",this.speechTriangle=document.createElementNS("http://www.w3.org/2000/svg","path"),this.speechTriangle.setAttribute("fill",t),this.speechSvg.append(this.speechTriangle),this.element.prepend(this.speechSvg)}updateSpeechBubble(t,e,s,n,i,a,o="white",r=20){const l=this.constructor.horizontalBaseStartMultiplier,c=this.constructor.horizontalBaseEndMultiplier,h=this.constructor.verticalBaseStartMultiplier,d=this.constructor.verticalBaseEndMultiplier,p=this.getPointDirection(t,e,s,n,i,a,this.directionPadding);let u="";if("br"===p)this.baseStartX=s-s*l*2,this.baseEndX=this.baseStartX+s*c,this.baseStartY=n,this.baseEndY=n,this.pointX=i-t,this.pointY=a-e,this.height=a-e+"px",u=`L${s} ${n} L${s} 0 L0 0 L0 ${this.baseStartY} L${this.baseStartX} ${this.baseStartY}`,this.textWidth=s,this.textHeight=n,this.textX=0,this.textY=0;else if("bl"===p)this.baseStartX=s*l,this.baseEndX=this.baseStartX+s*c,this.baseStartY=n,this.baseEndY=n,this.pointX=i-t,this.pointY=a-e,this.height=`${a-e}px`,u=`L${s} ${n} L${s} 0 L0 0 L0 ${this.baseStartY} L${this.baseStartX} ${this.baseStartY}`,this.textWidth=s,this.textHeight=n,this.textX=0,this.textY=0;else if("tr"===p){this.baseStartX=s-s*l*2,this.baseEndX=this.baseStartX+s*c;const o=e-a;this.baseStartY=o,this.baseEndY=o,this.top=e-o+"px",this.height=n+o+"px",this.pointX=i-t,this.pointY=0,u=`L${s} ${o} L${s} ${n+o} L0 ${n+o} L0 ${o} L${this.baseStartX} ${this.baseStartY}`,this.textWidth=s,this.textHeight=n,this.textX=0,this.textY=o}else if("tl"===p){this.baseStartX=s*l,this.baseEndX=this.baseStartX+s*c;const o=e-a;this.baseStartY=o,this.baseEndY=o,this.top=e-o+"px",this.height=n+o+"px",this.pointX=i-t,this.pointY=0,u=`L${s} ${o} L${s} ${n+o} L0 ${n+o} L0 ${o} L${this.baseStartX} ${this.baseStartY}`,this.textWidth=s,this.textHeight=n,this.textX=0,this.textY=o}else if("r"===p){const o=i-(t+s);this.baseStartX=s,this.baseEndX=s,this.width=s+o+"px",this.baseStartY=n*h,this.baseEndY=this.baseStartY+n*d,this.pointX=s+o,this.pointY=a-e,u=`L${this.baseStartX} ${n} L0 ${n} L0 0 L${this.baseStartX} 0 L${this.baseStartX} ${this.baseStartY}`,this.textWidth=s,this.textHeight=n,this.textX=0,this.textY=0}else if("l"===p){const o=t-i;this.baseStartX=o,this.baseEndX=o,this.left=t-o+"px",this.width=s+o+"px",this.baseStartY=n*h,this.baseEndY=this.baseStartY+n*d,this.pointX=0,this.pointY=a-e,u=`L${this.baseStartX} ${n} L${s+this.baseStartX} ${n} L${s+this.baseStartX} 0 L${this.baseStartX} 0 L${this.baseStartX} ${this.baseStartY}`,this.textWidth=s,this.textHeight=n,this.textX=o,this.textY=0}this.textElement&&(this.textElement.style.left=this.textX+"px",this.textElement.style.top=this.textY+"px",this.textElement.style.width=this.textWidth+"px",this.textElement.style.height=this.textHeight+"px"),this.closeElement&&this.closeButtonSize&&(this.closeElement.style.left=this.textX+this.textWidth+this.closeButtonSize/this.closeButtonOffset+"px",this.closeElement.style.top=this.textY+this.closeButtonSize/this.closeButtonOffset+"px");const $=`M${this.baseStartX} ${this.baseStartY} L${this.pointX} ${this.pointY} L${this.baseEndX} ${this.baseEndY} ${u}`;this.speechTriangle.setAttribute("d",$)}updateCloseSize(t){const e=t*this.closeButtonScaling;this.closeElement.style.width=e+"px",this.closeElement.style.height=e+"px",this.closeButtonSize=e}setupHoverAppearance(){const{bgOpacity:t,bgColor:e}=this.data;this.speechTriangle.addEventListener("mouseover",()=>{this.closeElement.style.display="block",this.closeElement.style.cursor="pointer",this.speechTriangle.setAttribute("fill",getFinalAnnotationColor(t,e,!0))}),this.speechTriangle.addEventListener("mouseout",s=>{s.relatedTarget.classList.contains("__cxt-ar-annotation-close__")||(this.closeElement.style.display="none",this.closeElement.style.cursor="default",this.speechTriangle.setAttribute("fill",getFinalAnnotationColor(t,e,!1)))}),this.closeElement.addEventListener("mouseleave",()=>{this.closeElement.style.display="none",this.closeElement.style.cursor="default",this.speechTriangle.style.cursor="default",this.speechTriangle.setAttribute("fill",getFinalAnnotationColor(t,e,!1))}),"url"===this.data.actionType&&(this.element.style.cursor="pointer")}setPadding(t,e){t=t*this.paddingMultiplier+"px",e=e*this.paddingMultiplier+"px",this.textElement&&(this.textElement.style.padding=`${e} ${t} ${e} ${t}`)}}}()}function file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cindex$2ejs(module,exports,require,__filename,__dirname,__import_meta){with(Object.defineProperty(exports,"__esModule",{value:!0}),function(){const t=require._esModule("./annotations/note.js"),e=require._esModule("./annotations/speech.js");return Object.freeze(Object.create(null,{[Symbol.toStringTag]:{value:"ModuleImports"},NoteAnnotation:{get:()=>t.default,enumerable:!0},SpeechAnnotation:{get:()=>e.default,enumerable:!0}}))}())!function(){"use strict";window.AnnotationRenderer=class{constructor(t,e,s,n=200){if(!t)throw new Error("Annotation objects must be provided");if(!e)throw new Error("An element to contain the annotations must be provided");s&&s.getVideoTime&&s.seekTo?this.playerOptions=s:console.info("AnnotationRenderer is running without a player. The update method will need to be called manually."),this.annotations=[],this.container=e,this.annotationsContainer=document.createElement("div"),this.annotationsContainer.classList.add("__cxt-ar-annotations-container__"),this.annotationsContainer.setAttribute("data-layer","4"),this.annotationsContainer.addEventListener("click",t=>{this.annotationClickHandler(t)}),this.container.prepend(this.annotationsContainer),this.createAnnotationElements(t),this.updateAllAnnotationSizes(),window.addEventListener("DOMContentLoaded",t=>{this.updateAllAnnotationSizes()}),this.updateInterval=n,this.updateIntervalId=null}changeAnnotationData(t){this.stop(),this.removeAnnotationElements(),this.annotations=t,this.createAnnotationElements(),this.start()}createAnnotationElements(t){for(const e of t){let t;t="speech"===e.style?new SpeechAnnotation(e):new NoteAnnotation(e),this.annotations.push(t),this.annotationsContainer.append(t.element)}}createCloseElement(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("viewBox","0 0 100 100"),t.classList.add("__cxt-ar-annotation-close__");const e=document.createElementNS(t.namespaceURI,"path");e.setAttribute("d","M25 25 L 75 75 M 75 25 L 25 75"),e.setAttribute("stroke","#bbb"),e.setAttribute("stroke-width",10),e.setAttribute("x",5),e.setAttribute("y",5);const s=document.createElementNS(t.namespaceURI,"circle");return s.setAttribute("cx",50),s.setAttribute("cy",50),s.setAttribute("r",50),t.append(s,e),t}removeAnnotationElements(){for(const t of this.annotations)t.element.remove()}update(t){for(const e of this.annotations){if(e.closed)continue;const s=e.data.timeStart,n=e.data.timeEnd;e.hidden&&t>=s&&t<n?e.show():!e.hidden&&(t<s||t>n)&&e.hide()}}start(){if(!this.playerOptions)throw new Error("playerOptions must be provided to use the start method");const t=this.playerOptions.getVideoTime();this.updateIntervalId||(this.update(t),this.updateIntervalId=setInterval(()=>{const t=this.playerOptions.getVideoTime();this.update(t),window.dispatchEvent(new CustomEvent("__ar_renderer_start"))},this.updateInterval))}stop(){if(!this.playerOptions)throw new Error("playerOptions must be provided to use the stop method");const t=this.playerOptions.getVideoTime();this.updateIntervalId&&(this.update(t),clearInterval(this.updateIntervalId),this.updateIntervalId=null,window.dispatchEvent(new CustomEvent("__ar_renderer_stop")))}updateAnnotationDimensions(t,e,s){const n=this.container.getBoundingClientRect().width,i=this.container.getBoundingClientRect().height,a=n/e,o=i/s;let r=n,l=i;a%1==0&&o%1==0||(a>o?(r=i/s*e,l=i):o>a&&(r=n,l=n/e*s));const c=(n-r)/2/n*100,h=(i-l)/2/i*100,d=r/n,p=l/i;for(const e of t){let t=c+e.data.x*d,s=h+e.data.y*p,a=e.data.width*d,o=e.data.height*p;e.setDimensions(`${t}%`,`${s}%`,`${a}%`,`${o}%`);let u=.008*r,$=.008*l;if(e.setPadding(u,$),"speech"===e.style&&e.speechSvg){const r=this.percentToPixels(n,t),l=this.percentToPixels(i,s),u=this.percentToPixels(n,a),$=this.percentToPixels(i,o);let m=c+e.data.sx*d,g=h+e.data.sy*p;m=this.percentToPixels(n,m),g=this.percentToPixels(i,g),e.updateSpeechBubble(r,l,u,$,m,g,null)}e.updateTextSize(l),e.updateCloseSize(l)}}updateAllAnnotationSizes(){if(this.playerOptions&&this.playerOptions.getOriginalVideoWidth&&this.playerOptions.getOriginalVideoHeight){const t=this.playerOptions.getOriginalVideoWidth(),e=this.playerOptions.getOriginalVideoHeight();this.updateAnnotationDimensions(this.annotations,t,e)}else{const t=this.container.getBoundingClientRect().width,e=this.container.getBoundingClientRect().height;this.updateAnnotationDimensions(this.annotations,t,e)}}hideAll(){for(const t of this.annotations)t.hide()}annotationClickHandler(t){let e=t.target;if(!e.matches(".__cxt-ar-annotation__")&&!e.closest(".__cxt-ar-annotation-close__")&&!(e=e.closest(".__cxt-ar-annotation__")))return null;let s=e.__annotation;if(e&&s)if("time"===s.actionType){const t=s.actionSeconds;if(this.playerOptions){this.playerOptions.seekTo(t);const e=this.playerOptions.getVideoTime();this.update(e)}window.dispatchEvent(new CustomEvent("__ar_seek_to",{detail:{seconds:t}}))}else if("url"===s.actionType){const t={url:s.actionUrl,target:s.actionUrlTarget||"current"},e=this.extractTimeHash(new URL(t.url));e&&e.hasOwnProperty("seconds")&&(t.seconds=e.seconds),window.dispatchEvent(new CustomEvent("__ar_annotation_click",{detail:t}))}}setUpdateInterval(t){this.updateInterval=t,this.stop(),this.start()}extractTimeHash(t){if(!t)throw new Error("A URL must be provided");const e=t.hash;if(e&&e.startsWith("#t=")){const e=t.hash.split("#t=")[1];return{seconds:this.timeStringToSeconds(e)}}return!1}timeStringToSeconds(t){let e=0;const s=t.split("h"),n=(s[1]||t).split("m"),i=(n[1]||t).split("s");return s[0]&&2===s.length&&(e+=60*parseInt(s[0],10)*60),n[0]&&2===n.length&&(e+=60*parseInt(n[0],10)),i[0]&&2===i.length&&(e+=parseInt(i[0],10)),e}percentToPixels(t,e){return t*e/100}}}()}Pax.baseRequire="undefined"!=typeof require?require:t=>{throw new Error(`Could not resolve module name: ${t}`)},Pax.modules={},Pax.files={},Pax.mains={},Pax.resolve=((t,e)=>{(t=t.split("/")).shift();for(const s of e.split("/"))".."===s?t.pop():"."!==s&&t.push(s);return"/"+t.join("/")}),Pax.Module=function(t,e){this.filename=t,this.id=t,this.loaded=!1,this.parent=e,this.children=[],this.exports={}},Pax.makeRequire=(t=>{const e=t=>e._module(t).exports;return e._deps={},e.main=t,e._esModule=(t=>{const s=e._module(t);return s.exports.__esModule?s.exports:{get default(){return s.exports}}}),e._module=(s=>{let n=t?e._deps[s]:Pax.main;if(null==n){const t={exports:Pax.baseRequire(s)};return e._deps[s]={module:t},t}if(n.module)return n.module;const i=new Pax.Module(n.filename,t);return n.module=i,i.require=Pax.makeRequire(i),i.require._deps=n.deps,i.require.main=t?t.require.main:i,t&&t.children.push(i),n(i,i.exports,i.require,n.filename,n.filename.split("/").slice(0,-1).join("/"),{url:"file://"+("/"===n.filename.charAt(0)?"":"/")+n.filename}),i.loaded=!0,i}),e}),Pax.files["C:/Users/Steven E Nyman/Programming/AnnotationsRestored/js/annotationlib/src/renderer/annotations/note.js"]=file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cnote$2ejs,file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cnote$2ejs.deps={},file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cnote$2ejs.filename="C:/Users/Steven E Nyman/Programming/AnnotationsRestored/js/annotationlib/src/renderer/annotations/note.js",Pax.files["C:/Users/Steven E Nyman/Programming/AnnotationsRestored/js/annotationlib/src/renderer/annotations/speech.js"]=file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cspeech$2ejs,file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cspeech$2ejs.deps={"./note.js":file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cnote$2ejs},file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cspeech$2ejs.filename="C:/Users/Steven E Nyman/Programming/AnnotationsRestored/js/annotationlib/src/renderer/annotations/speech.js",Pax.files["C:/Users/Steven E Nyman/Programming/AnnotationsRestored/js/annotationlib/src/renderer/index.js"]=file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cindex$2ejs,file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cindex$2ejs.deps={"./annotations/speech.js":file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cspeech$2ejs,"./annotations/note.js":file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cannotations$5cnote$2ejs},file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cindex$2ejs.filename="C:/Users/Steven E Nyman/Programming/AnnotationsRestored/js/annotationlib/src/renderer/index.js",Pax.main=file_C$3a$5cUsers$5cSteven$20E$20Nyman$5cProgramming$5cAnnotationsRestored$5cjs$5cannotationlib$5csrc$5crenderer$5cindex$2ejs,Pax.makeRequire(null)(),"undefined"!=typeof module&&(module.exports=Pax.main.module&&Pax.main.module.exports)}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this);